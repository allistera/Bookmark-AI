javascript:!function(){const n="YOUR_WORKER_URL",t=window.location.href,e=document.title,o=function(t){t.origin===n.replace(/\/$/,"")&&"BOOKMARK_AI_RESPONSE"===t.data.type&&(!function(n){const t=document.querySelector("#bookmark-ai-overlay div");if(!t)return;if(n.success&&n.data.success&&n.data.data){const e=n.data.data,o=e.categories?e.categories.join(", "):"N/A",r=e.matchedCategory||"N/A",a=e.instapaper?.saved?'<span style="color:#10b981;">✓ Saved</span>':e.instapaper?.error?'<span style="color:#ef4444;">✗ Error</span>':'<span style="color:#6b7280;">Not saved</span>',i=e.todoist?.created?'<span style="color:#10b981;">✓ Task created</span>':e.todoist?.error?'<span style="color:#ef4444;">✗ Error: '+e.todoist.error+"</span>":null;t.innerHTML=`\n                <div>\n                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">\n                        <h2 style="color:#667eea;margin:0;">Analysis</h2>\n                        <button class="bookmark-ai-close-btn"\n                                style="background:#ef4444;color:white;border:none;border-radius:50%;width:30px;height:30px;cursor:pointer;font-size:20px;">×</button>\n                    </div>\n\n                    <div style="margin-bottom:15px;">\n                        <strong style="color:#764ba2;">Title:</strong>\n                        <p style="margin:5px 0 0 0;">${e.title}</p>\n                    </div>\n\n                    <div style="margin-bottom:15px;">\n                        <strong style="color:#764ba2;">Content Type:</strong>\n                        <p style="margin:5px 0 0 0;">\n                            <span style="background:#e6f7ff;padding:4px 8px;border-radius:4px;">${e.contentType}</span>\n                        </p>\n                    </div>\n\n                    <div style="margin-bottom:15px;">\n                        <strong style="color:#764ba2;">Summary:</strong>\n                        <p style="margin:5px 0 0 0;">${e.summary}</p>\n                    </div>\n\n                    <div style="margin-bottom:15px;">\n                        <strong style="color:#764ba2;">Categories:</strong>\n                        <p style="margin:5px 0 0 0;">${o}</p>\n                    </div>\n\n                    ${e.matchedCategory?`\n                    <div style="margin-bottom:15px;">\n                        <strong style="color:#764ba2;">Matched:</strong>\n                        <p style="margin:5px 0 0 0;font-family:monospace;font-size:0.9em;">${r}</p>\n                    </div>\n                    `:""}\n\n                    <div style="margin-bottom:15px;">\n                        <strong style="color:#764ba2;">Instapaper:</strong>\n                        <p style="margin:5px 0 0 0;">${a}</p>\n                    </div>\n\n                    ${i?`\n                    <div style="margin-bottom:15px;">\n                        <strong style="color:#764ba2;">Todoist:</strong>\n                        <p style="margin:5px 0 0 0;">${i}</p>\n                    </div>\n                    `:""}\n\n                    <button class="bookmark-ai-close-btn"\n                            style="background:#667eea;color:white;border:none;padding:12px 24px;border-radius:6px;cursor:pointer;width:100%;margin-top:20px;">\n                        Close\n                    </button>\n                </div>\n            `}else{const e=n.error||n.data?.error||"Failed to analyze";t.innerHTML=`\n                <div>\n                    <h2 style="color:#ef4444;margin-bottom:20px;">Error</h2>\n                    <p style="margin-bottom:20px;">${e}</p>\n                    <button class="bookmark-ai-close-btn"\n                            style="background:#ef4444;color:white;border:none;padding:12px 24px;border-radius:6px;cursor:pointer;width:100%;">\n                        Close\n                    </button>\n                </div>\n            `}}(t.data),window.removeEventListener("message",o))};window.addEventListener("message",o);const r=document.createElement("div");r.id="bookmark-ai-overlay",r.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:999999;display:flex;align-items:center;justify-content:center;font-family:system-ui,-apple-system,sans-serif;";const a=document.createElement("div");a.style.cssText="background:white;border-radius:12px;padding:30px;max-width:600px;width:90%;max-height:80vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,0.3);",a.innerHTML=`\n        <div>\n            <h2 style="color:#667eea;margin-bottom:20px;">Analyze Bookmark</h2>\n            <p style="margin-bottom:15px;color:#666;">URL: <span style="word-break:break-all;font-size:0.9em;">${t}</span></p>\n\n            <div style="margin:20px 0;padding:15px;background:#f7fafc;border-radius:8px;">\n                <label style="display:flex;align-items:center;cursor:pointer;">\n                    <input type="checkbox" id="todoist-checkbox" style="margin-right:10px;width:18px;height:18px;cursor:pointer;">\n                    <span style="color:#333;">Create task in Todoist</span>\n                </label>\n            </div>\n\n            <div style="display:flex;gap:10px;margin-top:20px;">\n                <button id="analyze-btn" style="flex:1;background:#667eea;color:white;border:none;padding:12px 24px;border-radius:6px;cursor:pointer;font-size:1em;">\n                    Analyze\n                </button>\n                <button class="bookmark-ai-close-btn" style="flex:1;background:#e2e8f0;color:#333;border:none;padding:12px 24px;border-radius:6px;cursor:pointer;font-size:1em;">\n                    Cancel\n                </button>\n            </div>\n        </div>\n    `,r.appendChild(a),document.body.appendChild(r),r.addEventListener("click",function(n){(n.target===r||n.target.classList.contains("bookmark-ai-close-btn"))&&r.remove()}),document.getElementById("analyze-btn").addEventListener("click",function(){const o=document.getElementById("todoist-checkbox").checked;a.innerHTML='\n            <div style="text-align:center;">\n                <h2 style="color:#667eea;margin-bottom:20px;">Analyzing...</h2>\n                <div style="border:4px solid #f3f3f3;border-top:4px solid #667eea;border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite;margin:20px auto;"></div>\n            </div>\n            <style>\n                @keyframes spin {\n                    0% { transform: rotate(0deg); }\n                    100% { transform: rotate(360deg); }\n                }\n            </style>\n        ',function(t,e,o){const r=new URLSearchParams({url:t,title:e,todoist:o.toString()}),a=n+"/bridge?"+r.toString();if(!window.open(a,"bookmark-ai-bridge","width=400,height=300,left=100,top=100")){const n=document.querySelector("#bookmark-ai-overlay div");n&&(n.innerHTML='\n                    <div>\n                        <h2 style="color:#ef4444;margin-bottom:20px;">Popup Blocked</h2>\n                        <p style="margin-bottom:20px;">Please allow popups for this bookmarklet to work.</p>\n                        <button class="bookmark-ai-close-btn"\n                                style="background:#ef4444;color:white;border:none;padding:12px 24px;border-radius:6px;cursor:pointer;width:100%;">\n                            Close\n                        </button>\n                    </div>\n                ')}}(t,e,o)})}();
